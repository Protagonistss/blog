---
title: "Windows 终端中文乱码解决方案"
description: "全面解决 Windows 终端、PowerShell、Git 等工具中的中文乱码问题"
tags: ["windows", "powershell", "git", "编码", "终端"]
categories: ["windows"]
draft: false
techStack: "shell"
pubDate: "2025-11-14 14:35:09.000Z"
---

## 问题描述

在 Windows 环境下使用各种终端工具时，经常会遇到中文显示乱码的问题：

- **PowerShell 终端中文乱码**
- **Git 提交信息和文件名乱码**
- **命令行工具输出乱码**
- **编辑器终端中文乱码**

这些问题的根本原因是 Windows 默认编码（GBK/GB2312）与 UTF-8 编码不兼容导致的。

## PowerShell 终端乱码解决方案

### 问题现象
- 中文输出显示为乱码
- 中文输入无法正确处理
- Git 命令中文参数乱码

### 配置步骤

#### 1. 打开 PowerShell 配置文件

```powershell
notepad $PROFILE
```

如果配置文件不存在，系统会提示创建新的配置文件。

#### 2. 添加 UTF-8 编码配置

将以下代码添加到 PowerShell 配置文件中：

```powershell
# 设置 UTF-8 编码，解决终端中文乱码问题
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
[Console]::InputEncoding = [System.Text.Encoding]::UTF8
$OutputEncoding = [System.Text.Encoding]::UTF8
chcp 65001 | Out-Null
```

#### 3. 重新加载配置

保存文件后，重新打开 PowerShell 终端，或执行以下命令重新加载：

```powershell
. $PROFILE
```

### 配置说明

| 配置项 | 说明 |
|--------|------|
| `[Console]::OutputEncoding` | 设置控制台输出编码为 UTF-8 |
| `[Console]::InputEncoding` | 设置控制台输入编码为 UTF-8 |
| `$OutputEncoding` | 设置 PowerShell 输出编码为 UTF-8 |
| `chcp 65001` | 将代码页设置为 UTF-8（65001 是 UTF-8 的代码页编号） |

## Git 乱码解决方案

### 问题现象
- 中文文件名显示为转义字符
- 提交信息中文乱码
- 日志输出中文乱码
- 分支名中文乱码

### Git 配置命令

#### 核心编码配置

```bash
# 设置 Git 编码相关配置
git config --global core.quotepath false
git config --global gui.encoding utf-8
git config --global i18n.commitencoding utf-8
git config --global i18n.logoutputencoding utf-8
```

#### 一次性设置脚本

```bash
# Windows PowerShell 一键配置
git config --global core.quotepath false && `
git config --global gui.encoding utf-8 && `
git config --global i18n.commitencoding utf-8 && `
git config --global i18n.logoutputencoding utf-8
```

### 配置详解

| 配置项 | 值 | 作用 |
|--------|-----|------|
| `core.quotepath` | `false` | 显示中文路径名，不进行八进制转义 |
| `gui.encoding` | `utf-8` | Git GUI 界面使用 UTF-8 编码 |
| `i18n.commitencoding` | `utf-8` | 提交信息使用 UTF-8 编码 |
| `i18n.logoutputencoding` | `utf-8` | 日志输出使用 UTF-8 编码 |

### 配置文件位置

- **Windows**: `C:\Users\<用户名>\.gitconfig`
- **Git Bash**: `~/.gitconfig`

## 其他终端工具配置

### Windows Terminal

在 Windows Terminal 设置中，确保使用 UTF-8 编码：

```json
{
  "profiles": {
    "defaults": {
      "fontFace": "Consolas",
      "fontSize": 11,
      "colorScheme": "Campbell Powershell"
    }
  },
  "schemes": [],
  "keybindings": []
}
```

### VS Code 终端

在 VS Code 设置中添加：

```json
{
  "terminal.integrated.encoding": "utf8",
  "terminal.integrated.shell.windows": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
  "terminal.integrated.shellArgs.windows": [
    "-NoExit",
    "-Command",
    "chcp 65001"
  ]
}
```

## 环境变量配置（可选）

在系统环境变量中添加以下变量，可以进一步改善中文支持：

```powershell
# 设置语言环境变量
$env:LANG = "zh_CN.UTF-8"
$env:LC_ALL = "zh_CN.UTF-8"
$env:PYTHONIOENCODING = "utf-8"
```

## 验证配置效果

### PowerShell 测试

```powershell
# 测试中文输出
echo "测试中文显示：你好世界"

# 测试 Git 状态
git status

# 测试中文文件名显示
ls | Where-Object { $_.Name -match "[\u4e00-\u9fff]" }
```

### Git 测试

```bash
# 查看配置
git config --list | grep -E "(encoding|quotepath)"

# 测试中文提交
echo "测试内容" > 测试文件.txt
git add .
git commit -m "测试：添加中文文件名和提交信息"

# 查看日志
git log --oneline
```

## 常见问题排查

### 问题1：配置后仍显示乱码

**可能原因**：
- 终端字体不支持中文
- 系统语言设置不正确
- 某些应用未使用 UTF-8

**解决方案**：
1. 检查终端字体设置
2. 确认系统区域设置为中文
3. 重启终端应用

### 问题2：Git 提交信息乱码

**可能原因**：
- Git 客户端编码设置问题
- 编辑器编码不匹配

**解决方案**：
```bash
# 重新设置 Git 编码
git config --global i18n.commitencoding utf-8
git config --global i18n.logoutputencoding utf-8
```

### 问题3：VS Code 终端乱码

**解决方案**：
在 VS Code 设置中添加：
```json
"terminal.integrated.encoding": "utf8"
```

## 总结

通过以上配置，可以彻底解决 Windows 环境下各种终端工具的中文乱码问题：

1. **PowerShell**: 配置 `$PROFILE` 文件设置 UTF-8 编码
2. **Git**: 设置全局编码配置参数
3. **其他工具**: 根据具体工具调整编码设置

建议按照上述顺序逐步配置，配置完成后重启相关应用程序以确保设置生效。